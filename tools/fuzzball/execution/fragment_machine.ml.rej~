--- execution/fragment_machine.ml	2015-12-01 16:33:04.886525074 -0600
+++ execution/fragment_machine.ml	2015-10-19 17:52:29.437186000 -0500
@@ -263,7 +270,8 @@
 	     Hashtbl.add unique_eips eip ())));
       (* Libasmir.print_disasm_rawbytes Libasmir.Bfd_arch_i386 eip insn_bytes;
 	 print_string "\n"; *)
-      self#watchpoint
+      self#watchpoint;
+			List.iter(fun f -> f eip) custom_eip_hooks
 
     method get_eip =
       match !opt_arch with
@@ -1095,7 +1126,7 @@
 	v
 
     method private eval_int_exp_simplify exp =
-      match self#eval_int_exp_ty exp with
+			match self#eval_int_exp_ty exp with
 	| (v, V.REG_1) -> form_man#simplify1 v
 	| (v, V.REG_8) -> form_man#simplify8 v
 	| (v, V.REG_16) -> form_man#simplify16 v
@@ -1169,8 +1200,8 @@
 			 jump (self#eval_label_exp l1)
 		       else
 			 jump (self#eval_label_exp l2)
-		 | V.Move(V.Temp(v), e) ->
-		     self#set_int_var v (self#eval_int_exp_simplify e);
+		 | V.Move(V.Temp(v), e) -> 
+				self#set_int_var v (self#eval_int_exp_simplify e);
 		     loop rest
 		 | V.Move(V.Mem(memv, idx_e, ty), rhs_e) ->
 		     self#handle_store idx_e ty rhs_e;
@@ -1561,14 +1596,22 @@
   method virtual init_prog : Vine.program -> unit
   method virtual set_frag : Vine.program -> unit
   method virtual concretize_misc : unit
+	method virtual set_eip_hook : (int64 -> unit) -> unit
   method virtual eip_hook : int64 -> unit
   method virtual get_eip : int64
   method virtual set_eip : int64 -> unit
   method virtual run_eip_hooks : unit
+	method virtual run_store_hooks : int64 -> int -> string -> unit
+	method virtual set_store_hook : (int64 -> int -> string -> unit) -> unit
+	method virtual run_load_hooks : int64 -> int -> unit
+	method virtual set_load_hook : (int64 -> int -> unit) -> unit 	
   
   method virtual set_cjmp_heuristic :
     (int64 -> int64 -> int64 -> float -> bool option -> bool option) -> unit
 
+  method virtual set_finish_path_hook :
+    (unit -> unit) -> unit
+
   method virtual on_missing_zero : unit
   method virtual on_missing_random : unit
   method virtual on_missing_symbol : unit
@@ -1655,7 +1698,8 @@
   method virtual store_symbolic_wcstr : int64 -> int -> unit
 
   method virtual store_symbolic_byte  : int64 -> string -> unit
-  method virtual store_symbolic_short : int64 -> string -> unit
+  method virtual store_symbolic_byte_expr : int64 -> V.exp -> unit
+	method virtual store_symbolic_short : int64 -> string -> unit
   method virtual store_symbolic_word  : int64 -> string -> unit
   method virtual store_symbolic_long  : int64 -> string -> unit
 
@@ -1697,6 +1741,10 @@
 
   method virtual print_backtrace : unit
 
+  method virtual eval_expr_to_string : Vine.exp -> string
+
+  method virtual eval_expr_to_string : Vine.exp -> string
+
   method virtual eval_expr_to_int64 : Vine.exp -> int64
       
   method virtual eval_expr_to_symbolic_expr : Vine.exp -> Vine.exp
